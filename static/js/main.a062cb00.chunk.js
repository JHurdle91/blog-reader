(this["webpackJsonpblog-reader"]=this["webpackJsonpblog-reader"]||[]).push([[0],{35:function(e,t,a){e.exports=a(73)},60:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(32),c=a.n(l),o=a(6),s=a(2),m=a(1),u=a(13),i=a.n(u),d=a(9),p=a.n(d),b="".concat("https://dry-everglades-20804.herokuapp.com","/auth"),f={register:function(e,t){return p.a.post("".concat(b,"/signup"),{username:e,password:t})},login:function(e,t){return p.a.post("".concat(b,"/signin"),{username:e,password:t}).then((function(e){return e.data.token&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))},logout:function(){localStorage.removeItem("user")},getCurrentUser:function(){var e=JSON.parse(localStorage.getItem("user"));if(e){var t=e.user;return t.token=e.token,t}return e}},E="https://dry-everglades-20804.herokuapp.com",v={getPosts:function(){return p.a.get("".concat(E,"/posts"))},getPost:function(e){return p.a.get("".concat(E,"/posts/").concat(e))},createPost:function(e,t,a,n){return p.a.post("".concat(E,"/posts/create"),{params:{userId:e,title:t,body:a,published:n}})},updatePost:function(e,t,a,n){return p.a.post("".concat(E,"/posts/").concat(e,"/update"),{params:{title:t,body:a,published:n}})},deletePost:function(e){return p.a.post("".concat(E,"/posts/").concat(e,"/delete"))},getComments:function(e){return p.a.get("".concat(E,"/posts/").concat(e,"/comments"))},deleteComment:function(e,t){return p.a.post("".concat(E,"/posts/").concat(e,"/comments/").concat(t,"/delete"))},postComment:function(e,t,a){return p.a.post("".concat(E,"/posts/").concat(e,"/comments/create"),{params:{postId:e,userId:t,text:a}})},togglePublished:function(e){return p.a.post("".concat(E,"/posts/").concat(e,"/published"))}},g=a(14),h=a.n(g),O=function(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(!1),s=Object(m.a)(o,2),u=s[0],i=s[1],d=e.post,p=Object(n.useState)(d.published),b=Object(m.a)(p,2),E=b[0],g=b[1],O=d.title,j=d.timestamp_formatted,N=d.text,C=d._id;Object(n.useEffect)((function(){v.getComments(C).then((function(e){c(e.data);var t=f.getCurrentUser();if(t){var a=[];t.roles.map((function(e){return a.push(e.name)})),i(a.includes("ROLE_ADMIN"))}}))}),[C]);var S=N.length>=100?N.substring(0,100)+"...":N;return r.a.createElement("div",{className:"PostListItem"},r.a.createElement("div",{onClick:function(){window.location.href="/posts/".concat(C)}},r.a.createElement("h2",null,O),r.a.createElement("div",null,j),r.a.createElement("p",null,S),1===l.length?r.a.createElement("div",null,"1 comment"):r.a.createElement("div",null,l.length," comments")),u?r.a.createElement("label",null,r.a.createElement(h.a,{onChange:function(){v.togglePublished(C),g(!E)},checked:E}),r.a.createElement("br",null),r.a.createElement("span",null,E?"Published":"Unpublished")):r.a.createElement("div",null))},j=function(){var e=Object(n.useState)([]),t=Object(m.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(!1),o=Object(m.a)(c,2),s=o[0],u=o[1];Object(n.useEffect)((function(){v.getPosts().then((function(e){l(e.data)}));var e=f.getCurrentUser();if(e){var t=[];e.roles.map((function(e){return t.push(e.name)})),u(t.includes("ROLE_ADMIN"))}}),[]);return r.a.createElement("div",{className:"PostList"},s&&r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",onClick:function(){window.location.href="/posts/create"}},"+ New Post"),r.a.createElement("br",null),r.a.createElement("br",null)),a.map((function(e){return e.published||s?r.a.createElement("div",{key:i()()},r.a.createElement(O,{post:e}),r.a.createElement("hr",null)):null})))},N=(a(59),a(60),function(){return r.a.createElement("div",{className:"App"},r.a.createElement(j,null))}),C=function(){var e=Object(n.useState)(void 0),t=Object(m.a)(e,2),a=t[0],l=t[1];Object(n.useEffect)((function(){var e=f.getCurrentUser();if(e){var t=[];e.roles.map((function(e){return t.push(e.name)})),l(e)}}),[]);return r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand navbar-dark bg-dark"},r.a.createElement(o.b,{to:"/",className:"navbar-brand"},"My Blog"),r.a.createElement("div",{className:"navbar-nav mr-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/home",className:"nav-link"},"Home"))),a?r.a.createElement("div",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/profile",className:"nav-link"},"Profile")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"/login",className:"nav-link",onClick:function(){f.logout()}},"Log Out"))):r.a.createElement("div",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/login",className:"nav-link"},"Log In")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{to:"/register",className:"nav-link"},"Sign Up")))),r.a.createElement("div",{className:"container mt-3"}))},S=function(e){return r.a.createElement("div",{className:"PostCreateForm"},r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"titleInput"},"Title:"),r.a.createElement("input",{id:"titleInput",name:"titleInput",onChange:function(t){t.preventDefault(),e.onChangeTitle(t.target.value)},className:"form-control",placeholder:"Title",value:e.title,required:!0}),r.a.createElement("label",{htmlFor:"bodyInput"},"Post Body:"),r.a.createElement("textarea",{id:"commentBox",name:"commentBox",onChange:function(t){t.preventDefault(),e.onChangeBody(t.target.value)},className:"form-control",type:"textarea",placeholder:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",value:e.body,required:!0}))))},k=function(e){return r.a.createElement("div",{className:"PostFormButtons"},r.a.createElement("button",{className:"btn btn-danger",onClick:function(t){t.preventDefault(),e.onClickCancel()}},"Cancel"),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-primary",onClick:function(t){t.preventDefault(),e.onClickSave()}},"Save Post (Unpublished)"),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-primary",onClick:function(t){t.preventDefault(),e.onClickSaveAndPublish()}},"Save and Publish Post"))},w=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(!1),o=Object(m.a)(c,2),s=o[0],u=o[1],i=Object(n.useState)(""),d=Object(m.a)(i,2),p=d[0],b=d[1],E=Object(n.useState)(""),g=Object(m.a)(E,2),h=g[0],O=g[1];Object(n.useEffect)((function(){var e=f.getCurrentUser();if(e){var t=[];e.roles.map((function(e){return t.push(e.name)})),l(t.includes("ROLE_ADMIN")),u(e)}}),[]);var j=function(e){p&&h?v.createPost(s._id,p,h,e).then((function(e){var t=e.data._id;window.location.href="/posts/".concat(t)})):alert("Title and Body are required.")};return r.a.createElement("div",{className:"PostCreate"},r.a.createElement("h1",null,"New Post"),r.a.createElement("hr",null),a?r.a.createElement("div",null,r.a.createElement(S,{onChangeTitle:function(e){b(e)},onChangeBody:function(e){O(e)}}),r.a.createElement("br",null),r.a.createElement(k,{onClickCancel:function(e){window.location.href="/posts/"},onClickSave:function(){j(!1)},onClickSaveAndPublish:function(){j(!0)}})):r.a.createElement("div",null,"Only the Admin can create new posts at this time..."))},y=function(e){var t=e.timestamp,a=e.text,n=e.commentAuthor,l=e.currentUser,c=e.admin,o=e.reloadComments,m=e.id,u=Object(s.f)().postId;return r.a.createElement("div",{className:"Comment"},r.a.createElement("div",null,r.a.createElement("strong",null,n.username)),r.a.createElement("div",null,t),r.a.createElement("br",null),r.a.createElement("div",null,a),l&&(l._id===n._id||c)?r.a.createElement("button",{className:"btn btn-danger",onClick:function(){v.deleteComment(u,m).then((function(){o()}))}},"Delete Comment"):r.a.createElement("div",null))},P=function(e){var t=e.comments,a=e.reloadComments;return r.a.createElement("div",{className:"Comments"},t.map((function(t){var n=t.timestamp_formatted,l=t.text,c=t.user,o=t._id,s=e.currentUser,m=e.admin;return r.a.createElement("div",{key:i()()},r.a.createElement(y,{id:o,timestamp:n,text:l,commentAuthor:c,currentUser:s,admin:m,reloadComments:a}),r.a.createElement("hr",null))})))},x=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(void 0),u=Object(m.a)(o,2),i=u[0],d=u[1],p=Object(s.f)().postId;Object(n.useEffect)((function(){var e=f.getCurrentUser();e&&d(e)}),[]);var b=function(t){t.preventDefault(),v.postComment(p,i.id,l).then((function(){e.reloadComments(),c("")}))};return r.a.createElement("div",{className:"CommentForm"},r.a.createElement("form",{onSubmit:b},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"commentBox"},"Leave a comment:"),r.a.createElement("br",null),r.a.createElement("textarea",{id:"commentBox",name:"commentBox",onChange:function(e){var t=e.target.value;c(t)},className:"form-control",type:"textarea",placeholder:"What an excellent post!",value:l,onKeyPress:function(e){13===e.which&&b(e)},required:!0})),r.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Submit"),r.a.createElement("br",null),r.a.createElement("br",null)))},I=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(void 0),u=Object(m.a)(c,2),i=u[0],d=u[1],p=Object(n.useState)({title:"",timestamp:"",timestamp_formatted:"",text:"",published:!1,user:{username:"",password:""}}),b=Object(m.a)(p,2),E=b[0],g=b[1],O=Object(s.f)().postId;Object(n.useEffect)((function(){v.getPost(O).then((function(e){g(e.data)}));var e=f.getCurrentUser();if(e){var t=[];e.roles.map((function(e){return t.push(e.name)})),l(t.includes("ROLE_ADMIN")),d(e)}}),[O]);var j=Object(n.useState)(E.published),N=Object(m.a)(j,2),C=N[0],S=N[1];Object(n.useEffect)((function(){S(E.published)}),[E.published]);var k=Object(n.useState)([]),w=Object(m.a)(k,2),y=w[0],I=w[1],U=Object(n.useCallback)((function(){v.getComments(O).then((function(e){I(e.data)}))}),[O]);Object(n.useEffect)((function(){U()}),[U]);var _=E.title,A=E.timestamp_formatted,D=E.text,B=E.user;return r.a.createElement("div",{className:"PostDetail"},r.a.createElement("h1",null,_),r.a.createElement("div",null,"- ",B.username),r.a.createElement("div",null,A),a?r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement(h.a,{onChange:function(){v.togglePublished(O),S(!C)},checked:C}),r.a.createElement("br",null),r.a.createElement("span",null,C?"Published":"Unpublished")),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-warning",onClick:function(){window.location.href="/posts/".concat(O,"/edit")}},"Edit Post"),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-danger",onClick:function(){v.deletePost(O).then((function(){window.location.href="/posts/"}))}},"Delete Post")):r.a.createElement("div",null),r.a.createElement("hr",null),r.a.createElement("div",null,D),r.a.createElement("hr",null),r.a.createElement("h2",null,"Comments"),i?r.a.createElement(x,{reloadComments:U}):r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(o.b,{to:"/login"},r.a.createElement("strong",null,"Log in"))," ","to leave a comment.",r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement(P,{currentUser:i,admin:a,comments:y,reloadComments:U}))},U=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(""),o=Object(m.a)(c,2),u=o[0],i=o[1],d=Object(n.useState)(""),p=Object(m.a)(d,2),b=p[0],E=p[1],g=Object(n.useState)({title:"",timestamp:"",timestamp_formatted:"",text:"",published:!1,user:{username:"",password:""}}),h=Object(m.a)(g,2),O=h[0],j=h[1],N=Object(s.f)().postId;Object(n.useEffect)((function(){v.getPost(N).then((function(e){j(e.data)}))}),[N]),Object(n.useEffect)((function(){i(O.title),E(O.text)}),[O]),Object(n.useEffect)((function(){var e=f.getCurrentUser();if(e){var t=[];e.roles.map((function(e){return t.push(e.name)})),l(t.includes("ROLE_ADMIN"))}}),[]);var C=function(e){u&&b?v.updatePost(N,u,b,e).then((function(){window.location.href="/posts/".concat(N)})):alert("Title and Body are required.")};return r.a.createElement("div",{className:"PostUpdate"},r.a.createElement("h1",null,"Update Post"),r.a.createElement("hr",null),a?r.a.createElement("div",null,r.a.createElement(S,{title:u,body:b,onChangeTitle:function(e){i(e)},onChangeBody:function(e){E(e)}}),r.a.createElement("br",null),r.a.createElement(k,{onClickCancel:function(){window.location.href="/posts/".concat(N)},onClickSave:function(){C(!1)},onClickSaveAndPublish:function(){C(!0)}})):r.a.createElement("div",null,"Only the Admin can update posts at this time..."))},_=a(15),A=a.n(_),D=a(12),B=a.n(D),L=a(16),T=a.n(L),q=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"This field is required!")},F=function(e){var t=Object(n.useRef)(),a=Object(n.useRef)(),l=Object(n.useState)(""),c=Object(m.a)(l,2),o=c[0],s=c[1],u=Object(n.useState)(""),i=Object(m.a)(u,2),d=i[0],p=i[1],b=Object(n.useState)(!1),E=Object(m.a)(b,2),v=E[0],g=E[1],h=Object(n.useState)(""),O=Object(m.a)(h,2),j=O[0],N=O[1];return r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"card card-container"},r.a.createElement("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),r.a.createElement(A.a,{onSubmit:function(n){n.preventDefault(),N(""),g(!0),t.current.validateAll(),0===a.current.context._errors.length?f.login(o,d).then((function(){e.history.push("/profile"),window.location.reload()}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();g(!1),N(t)})):g(!1)},ref:t},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(B.a,{type:"text",className:"form-control",name:"username",value:o,onChange:function(e){var t=e.target.value;s(t)},validations:[q]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(B.a,{type:"password",className:"form-control",name:"password",value:d,onChange:function(e){var t=e.target.value;p(t)},validations:[q]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:v},v&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,"Login"))),j&&r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"alert alert-danger",role:"alert"},j)),r.a.createElement(T.a,{style:{display:"none"},ref:a}))))},R=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"This field is required!")},M=function(e){if(e.length<3||e.length>20)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The username must be between 3 and 20 characters.")},J=function(e){if(e.length<6||e.length>40)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The password must be between 6 and 40 characters.")},H=function(e){var t=Object(n.useRef)(),a=Object(n.useRef)(),l=Object(n.useState)(""),c=Object(m.a)(l,2),o=c[0],s=c[1],u=Object(n.useState)(""),i=Object(m.a)(u,2),d=i[0],p=i[1],b=Object(n.useState)(!1),E=Object(m.a)(b,2),v=E[0],g=E[1],h=Object(n.useState)(!1),O=Object(m.a)(h,2),j=O[0],N=O[1],C=Object(n.useState)(""),S=Object(m.a)(C,2),k=S[0],w=S[1];return r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"card card-container"},r.a.createElement("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),r.a.createElement(A.a,{onSubmit:function(n){n.preventDefault(),w(""),g(!0),N(!1),t.current.validateAll(),0===a.current.context._errors.length?f.register(o,d).then((function(t){w(t.data.message),N(!0),f.login(o,d).then((function(){e.history.push("/profile"),window.location.reload()}))}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();w(t),g(!1),N(!1)})):g(!1)},ref:t},!j&&r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(B.a,{type:"text",className:"form-control",name:"username",value:o,onChange:function(e){var t=e.target.value;s(t)},validations:[R,M]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(B.a,{type:"password",className:"form-control",name:"password",value:d,onChange:function(e){var t=e.target.value;p(t)},validations:[R,J]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:v},v&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,"Sign Up")))),k&&r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:j?"alert alert-success":"alert alert-danger",role:"alert"},k)),r.a.createElement(T.a,{style:{display:"none"},ref:a}))))},K=function(){var e=f.getCurrentUser();return r.a.createElement("div",{className:"container"},r.a.createElement("header",{className:"jumbotron"},r.a.createElement("h3",null,r.a.createElement("strong",null,e.username)," Profile")),r.a.createElement("p",null,r.a.createElement("strong",null,"Token:")," ",e.token.substring(0,20)," ..."," ",e.token.substr(e.token.length-20)),r.a.createElement("p",null,r.a.createElement("strong",null,"Id:")," ",e.id),r.a.createElement("strong",null,"Authorities:"),r.a.createElement("ul",null,e.roles&&e.roles.map((function(e,t){return r.a.createElement("li",{key:t},e.name)}))))},W=function(){return r.a.createElement(o.a,{basename:"/blog-reader"},r.a.createElement(C,null),r.a.createElement(s.c,null,r.a.createElement(s.a,{exact:!0,path:["/","/home"],component:N}),r.a.createElement(s.a,{exact:!0,path:"/posts",component:N}),r.a.createElement(s.a,{path:"".concat("/posts","/create"),component:w}),r.a.createElement(s.a,{path:"".concat("/posts","/:postId/edit"),component:U}),r.a.createElement(s.a,{path:"".concat("/posts","/:postId"),component:I}),r.a.createElement(s.a,{exact:!0,path:"/login",component:F}),r.a.createElement(s.a,{exact:!0,path:"/register",component:H}),r.a.createElement(s.a,{exact:!0,path:"/profile",component:K})))};document.title="Blog Reader",c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(W,null)),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.a062cb00.chunk.js.map